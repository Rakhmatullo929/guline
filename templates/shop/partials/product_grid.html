{% load static %}

<!-- Product Grid -->
<div class="product-grid" id="product-grid">
    {% for product in products %}
        <div class="product-card" hx-boost="true" data-product-id="{{ product.id }}">
            <div class="product-image">
                <a href="{% url 'shop:product_detail' product.slug %}">
                    {% if product.main_image %}
                        <img src="{{ product.main_image.url }}" alt="{{ product.name }}" loading="lazy">
                    {% else %}
                        <div class="product-placeholder">
                            <i class="fas fa-tshirt"></i>
                        </div>
                    {% endif %}
                    {% if product.discount_percentage > 0 %}
                        <div class="discount-badge">-{{ product.discount_percentage }}%</div>
                    {% endif %}
                </a>
                <!-- Кнопка избранного в левом верхнем углу -->
                <button class="favorite-btn-left" 
                        data-product-id="{{ product.id }}"
                        hx-post="{% url 'shop:htmx_toggle_favorite' product.id %}"
                        hx-target="this"
                        hx-swap="outerHTML"
                        hx-include="[name='favorites']"
                        title="Добавить в избранное">
                    <i class="far fa-heart"></i>
                </button>
            </div>
            <div class="product-info">
                <h3 class="product-name">
                    <a href="{% url 'shop:product_detail' product.slug %}">{{ product.name }}</a>
                </h3>
                <div class="product-price">
                    {% if product.old_price %}
                        <span class="old-price">{{ product.old_price }} ₽</span>
                    {% endif %}
                    <span class="current-price">{{ product.price }} ₽</span>
                </div>
                <a href="{% url 'shop:product_detail' product.slug %}" class="view-btn">
                    Подробнее
                </a>
            </div>
        </div>
    {% empty %}
        <div class="no-products">
            <i class="fas fa-search"></i>
            <h3>Товары не найдены</h3>
            <p>Попробуйте изменить параметры поиска</p>
        </div>
    {% endfor %}
</div>

<!-- Pagination Component -->
{% include 'shop/partials/pagination.html' %}
